{"mappings":"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","sources":["index.ts","coins/xna.js","coins/xna-legacy.js"],"sourcesContent":["import * as bitcoin from \"bitcoinjs-lib\";\nimport { ECPairFactory } from \"ecpair\";\nimport ecc from \"@bitcoinerlab/secp256k1\";\n\nconst { xna } = require(\"./coins/xna\");\nconst { xnaLegacy } = require(\"./coins/xna-legacy\");\n\nfunction toBitcoinJS(network: any): bitcoin.Network {\n  return {\n    messagePrefix: network.messagePrefix,\n    bech32: network.bech32 || \"\",\n    bip32: {\n      public: network.versions.bip32.public,\n      private: network.versions.bip32.private,\n    },\n    pubKeyHash: network.versions.public,\n    scriptHash: network.versions.scripthash,\n    wif: network.versions.private,\n  };\n}\n\nconst ECPair = ECPairFactory(ecc);\n\ninterface IUTXO {\n  address: string;\n  assetName: string;\n  txid: string;\n  outputIndex: number;\n  script: string;\n  satoshis: number;\n  height?: number;\n  value: number;\n}\n\nexport function sign(\n  network: \"xna\" | \"xna-test\" | \"xna-legacy\" | \"xna-legacy-test\",\n  rawTransactionHex: string,\n  UTXOs: Array<IUTXO>,\n  privateKeys: Record<string, string>\n): string {\n  const networkMapper = {\n    xna: toBitcoinJS(xna.mainnet),\n    \"xna-test\": toBitcoinJS(xna.testnet),\n    \"xna-legacy\": toBitcoinJS(xnaLegacy.mainnet),\n    \"xna-legacy-test\": toBitcoinJS(xnaLegacy.testnet),\n  };\n\n  const COIN = networkMapper[network];\n  if (!COIN) throw new Error(\"Invalid network specified\");\n  COIN.bech32 = COIN.bech32 || \"\"; //ECPair requires bech32 to not be undefined\n\n  const COIN_NETWORK = COIN as bitcoin.Network;\n\n  const unsignedTx = bitcoin.Transaction.fromHex(rawTransactionHex);\n  const tx = new bitcoin.Transaction();\n  tx.version = unsignedTx.version;\n  tx.locktime = unsignedTx.locktime;\n\n  function getKeyPairByAddress(address: string) {\n    const wif = privateKeys[address];\n    if (!wif) throw new Error(`Missing private key for address: ${address}`);\n\n    try {\n      return ECPair.fromWIF(wif, COIN_NETWORK);\n    } catch (e) {\n      console.error(\"Failed to parse WIF:\", e);\n      throw e;\n    }\n  }\n\n  function getUTXO(txid: string, vout: number): IUTXO | undefined {\n    return UTXOs.find((u) => u.txid === txid && u.outputIndex === vout);\n  }\n\n  // Add inputs\n  for (let i = 0; i < unsignedTx.ins.length; i++) {\n    const input = unsignedTx.ins[i];\n    const txid = Buffer.from(input.hash).reverse().toString(\"hex\");\n    const vout = input.index;\n\n    const utxo = getUTXO(txid, vout);\n    if (!utxo) throw new Error(`Missing UTXO for input ${txid}:${vout}`);\n\n    const script = Buffer.from(utxo.script, \"hex\");\n    tx.addInput(Buffer.from(input.hash), input.index, input.sequence, script);\n  }\n\n  // Add outputs\n  for (const out of unsignedTx.outs) {\n    tx.addOutput(out.script, out.value);\n  }\n\n  // Sign each input\n  for (let i = 0; i < tx.ins.length; i++) {\n    const input = tx.ins[i];\n    const txid = Buffer.from(input.hash).reverse().toString(\"hex\");\n    const vout = input.index;\n\n    const utxo = getUTXO(txid, vout);\n    if (!utxo) throw new Error(`Missing UTXO for input ${txid}:${vout}`);\n\n    const keyPair = getKeyPairByAddress(utxo.address);\n    const scriptPubKey = Buffer.from(utxo.script, \"hex\");\n\n    const sighash = tx.hashForSignature(\n      i,\n      scriptPubKey,\n      bitcoin.Transaction.SIGHASH_ALL\n    );\n    const rawSignature = keyPair.sign(sighash);\n\n    const signatureWithHashType = bitcoin.script.signature.encode(\n      Buffer.from(rawSignature),\n      bitcoin.Transaction.SIGHASH_ALL\n    );\n\n    const pubKey = keyPair.publicKey;\n    const scriptSig = bitcoin.script.compile([\n      signatureWithHashType,\n      Buffer.from(pubKey),\n    ]);\n\n    tx.setInputScript(i, scriptSig);\n  }\n\n  return tx.toHex();\n}\n\nexport default {\n  sign,\n};\n","/**\n * Neurai (XNA) chain configuration data\n * This replaces the dependency on @hyperbitjs/chains with only the data needed for Neurai\n */\n\nconst xna = {\n  mainnet: {\n    name: \"Neurai\",\n    unit: \"XNA\",\n    symbol: \"xna\",\n    decimalPlaces: 100000000,\n    messagePrefix: \"Neurai Signed Message:\\n\",\n    confirmations: 6,\n    website: \"https://neurai.org/\",\n    projectUrl: \"https://github.com/NeuraiProject\",\n    id: \"94C49B3B-2C88-4408-B566-3D277C596778\",\n    network: \"mainnet\",\n    hashGenesisBlock: \"00000044d33c0c0ba019be5c0249730424a69cb4c222153322f68c6104484806\",\n    port: 19000,\n    portRpc: 19001,\n    protocol: {\n      magic: 1381320014\n    },\n    seedsDns: [\n      \"seed1.neurai.org\",\n      \"seed2.neurai.org\",\n      \"neurai-ipv4.neuraiexplorer.com\"\n    ],\n    versions: {\n      bip32: {\n        private: 76066276,\n        public: 76067358\n      },\n      bip44: 1900,\n      private: 128,\n      public: 53,\n      scripthash: 117\n    }\n  },\n  testnet: {\n    name: \"Neurai\",\n    unit: \"XNA\",\n    symbol: \"xna\",\n    decimalPlaces: 100000000,\n    messagePrefix: \"Neurai Signed Message:\\n\",\n    confirmations: 6,\n    website: \"https://neurai.org/\",\n    projectUrl: \"https://github.com/NeuraiProject\",\n    id: \"1EB2ACBA-E8E0-4970-BB20-37DA4B70F6A6\",\n    network: \"testnet\",\n    hashGenesisBlock: \"0000006af8b8297448605b0283473ec712f9768f81cc7eae6269b875dee3b0cf\",\n    port: 19100,\n    portRpc: 19101,\n    protocol: {\n      magic: 1313166674\n    },\n    seedsDns: [\n      \"testnet1.neuracrypt.org\",\n      \"testnet2.neuracrypt.org\",\n      \"testnet3.neuracrypt.org\"\n    ],\n    versions: {\n      bip32: {\n        private: 70615956,\n        public: 70617039\n      },\n      bip44: 1,\n      private: 239,\n      public: 127,\n      scripthash: 196\n    }\n  }\n};\n\nconst chains = {\n  xna\n};\n\nmodule.exports = {\n  xna,\n  chains\n};\n","/**\n * Neurai Legacy (XNA-LEGACY) chain configuration data\n * This replaces the dependency on @hyperbitjs/chains with only the data needed for Neurai Legacy\n */\n\nconst xnaLegacy = {\n  mainnet: {\n    name: \"Neurai\",\n    unit: \"XNA\",\n    symbol: \"xna\",\n    decimalPlaces: 100000000,\n    messagePrefix: \"Neurai Signed Message:\\n\",\n    confirmations: 6,\n    website: \"https://neurai.org/\",\n    projectUrl: \"https://github.com/NeuraiProject\",\n    id: \"94C49B3B-2C88-4408-B566-3D277C596778\",\n    network: \"mainnet\",\n    hashGenesisBlock: \"00000044d33c0c0ba019be5c0249730424a69cb4c222153322f68c6104484806\",\n    port: 19000,\n    portRpc: 19001,\n    protocol: {\n      magic: 1381320014\n    },\n    seedsDns: [\n      \"seed1.neurai.org\",\n      \"seed2.neurai.org\",\n      \"neurai-ipv4.neuraiexplorer.com\"\n    ],\n    versions: {\n      bip32: {\n        private: 76066276,\n        public: 76067358\n      },\n      bip44: 0,\n      private: 128,\n      public: 53,\n      scripthash: 117\n    }\n  },\n  testnet: {\n    name: \"Neurai\",\n    unit: \"XNA\",\n    symbol: \"xna\",\n    decimalPlaces: 100000000,\n    messagePrefix: \"Neurai Signed Message:\\n\",\n    confirmations: 6,\n    website: \"https://neurai.org/\",\n    projectUrl: \"https://github.com/NeuraiProject\",\n    id: \"1EB2ACBA-E8E0-4970-BB20-37DA4B70F6A6\",\n    network: \"testnet\",\n    hashGenesisBlock: \"0000006af8b8297448605b0283473ec712f9768f81cc7eae6269b875dee3b0cf\",\n    port: 19100,\n    portRpc: 19101,\n    protocol: {\n      magic: 1313166674\n    },\n    seedsDns: [\n      \"testnet1.neuracrypt.org\",\n      \"testnet2.neuracrypt.org\",\n      \"testnet3.neuracrypt.org\"\n    ],\n    versions: {\n      bip32: {\n        private: 70615956,\n        public: 70617039\n      },\n      bip44: 1,\n      private: 239,\n      public: 127,\n      scripthash: 196\n    }\n  }\n};\n\nconst chains = {\n  \"xna-legacy\": xnaLegacy\n};\n\nmodule.exports = {\n  xnaLegacy,\n  chains\n};\n"],"names":[],"version":3,"file":"index.mjs.map"}